{% extends 'base.html' %}
{% load static %}

{% block title %}Результаты поиска{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1 class="mb-4 text-primary">Результаты поиска</h1>

            {% if query %}
                <p class="text-secondary mb-4">По запросу "{{ query }}" найдено: {{ total_results }} результатов</p>
            {% endif %}

            <!-- Результаты новостей -->
            {% if news_results %}
            <div class="mb-5">
                <h3 class="border-bottom pb-2 mb-3 text-primary">
                    <i class="bi bi-newspaper text-primary me-2"></i>
                    Новости ({{ news_results.count }})
                </h3>
                {% for news in news_results %}
                <div class="card mb-3 search-card">
                    <div class="card-body">
                        <h5 class="card-title">
                            <a href="{% url 'news_detail' news.id %}" class="text-decoration-none card-link">
                                {{ news.title }}
                            </a>
                        </h5>
                        <p class="card-text text-muted small">
                            <i class="bi bi-calendar-event me-1"></i> {{ news.date|date:"d.m.Y" }}
                        </p>
                        <p class="card-text card-description">
                            {{ news.text|truncatewords:30 }}
                        </p>
                        <a href="{% url 'news_detail' news.id %}" class="btn btn-primary btn-sm">
                            Читать далее
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Результаты мероприятий -->
            {% if courses_results %}
            <div class="mb-5">
                <h3 class="border-bottom pb-2 mb-3 text-success">
                    <i class="bi bi-calendar-event text-success me-2"></i>
                    Мероприятия ({{ courses_results.count }})
                </h3>
                {% for course in courses_results %}
                <div class="card mb-3 search-card">
                    <div class="card-body">
                        <h5 class="card-title">
                            <a href="{% url 'course_detail' course.id %}" class="text-decoration-none card-link">
                                {{ course.title }}
                            </a>
                        </h5>
                        <p class="card-text text-muted small">
                            <i class="bi bi-clock me-1"></i> {{ course.date_range }}
                            {% if course.is_completed %}
                                <span class="badge bg-secondary ms-2">Завершено</span>
                            {% else %}
                                <span class="badge bg-success ms-2">Активно</span>
                            {% endif %}
                        </p>
                        {% if course.description %}
                        <p class="card-text card-description">
                            {{ course.description|truncatewords:30 }}
                        </p>
                        {% endif %}
                        <a href="{% url 'course_detail' course.id %}" class="btn btn-success btn-sm">
                            Подробнее
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Если ничего не найдено -->
            {% if not news_results and not courses_results and query %}
            <div class="text-center py-5 empty-state">
                <i class="bi bi-search display-1 text-muted"></i>
                <h3 class="mt-3 text-primary">Ничего не найдено</h3>
                <p class="text-secondary">Попробуйте изменить поисковый запрос</p>
                <a href="{% url 'home' %}" class="btn btn-primary mt-3">Вернуться на главную</a>
            </div>
            {% endif %}

            <!-- Если запрос пустой -->
            {% if not query %}
            <div class="text-center py-5 empty-state">
                <i class="bi bi-search display-1 text-muted"></i>
                <h3 class="mt-3 text-primary">Введите поисковый запрос</h3>
                <p class="text-secondary">Используйте поле поиска в шапке сайта</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
    .search-card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-light);
    }

    .search-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-medium);
        border-color: var(--nav-link-hover);
    }

    .card-link {
        color: var(--text-primary) !important;
        transition: color 0.3s ease;
    }

    .card-link:hover {
        color: var(--nav-link-hover) !important;
    }

    .card-description {
        color: var(--text-secondary);
        line-height: 1.5;
    }

    .empty-state {
        background-color: var(--bg-secondary);
        border-radius: 15px;
        padding: 3rem 2rem;
    }

    .btn-primary {
        background-color: var(--btn-primary-bg);
        border-color: var(--btn-primary-bg);
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        background-color: var(--btn-primary-hover);
        border-color: var(--btn-primary-hover);
        transform: translateY(-1px);
    }

    .btn-success {
        background-color: #28a745;
        border-color: #28a745;
        transition: all 0.3s ease;
    }

    .btn-success:hover {
        background-color: #218838;
        border-color: #1e7e34;
        transform: translateY(-1px);
    }

    .border-bottom {
        border-bottom-color: var(--border-color) !important;
    }

    .text-primary {
        color: var(--text-primary) !important;
    }

    .text-secondary {
        color: var(--text-secondary) !important;
    }

    .text-muted {
        color: var(--text-secondary) !important;
    }

    .badge {
        font-size: 0.75em;
    }
</style>
{% endblock %}